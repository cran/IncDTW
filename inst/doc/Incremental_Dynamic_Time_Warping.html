<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Leodolter Maximilian" />

<meta name="date" content="2019-06-27" />

<title>Incremental Dynamic Time Warping</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Incremental Dynamic Time Warping</h1>
<h4 class="author">Leodolter Maximilian</h4>
<h4 class="date">2019-06-27</h4>



<p>Dynamic Time Warping is a well known and often applied technic to measure the distance between two time series. (<a href="https://www.google.at/search?q=dynamic+time+warpinig&amp;oq=dynamic+time+warpinig&amp;aqs=chrome..69i57j0l5.4553j0j7&amp;sourceid=chrome&amp;ie=UTF-8">Google</a>) finds about 750,000 matches for the term <em>Dynamic Time Warping</em>. Searching the scientific search engines for research articles for this subject results in:</p>
<ul>
<li>(<a href="https://scholar.google.at/scholar?hl=en&amp;q=dynamic+time+warping&amp;btnG=&amp;as_sdt=1%2C5&amp;as_sdtp=">scholar.google</a>) finds about 117,000 hits</li>
<li>(<a href="http://dl.acm.org/results.cfm?query=Dynamic+Time+Warping&amp;Go.x=0&amp;Go.y=0">dl.acm.org</a>) more 130,000 hits</li>
<li>(<a href="http://www.sciencedirect.com/search?qs=dynamic+time+warping&amp;origin=article&amp;zone=qSearch">sciencedirect</a>) about 16,000 hits</li>
<li>(<a href="http://ieeexplore.ieee.org/search/searchresult.jsp?newsearch=true&amp;queryText=dynamic%20time%20warping">ieeexplore.org</a> about 2,000 hits</li>
</ul>
<p>To learn more about DTW interested readers may also read (<a href="https://en.wikipedia.org/wiki/Dynamic_time_warping">Wikipedia DTW</a>) or have look at this (<a href="http://www.phon.ox.ac.uk/jcoleman/old_SLP/Lecture_5/DTW_explanation.html">Simple Example</a>). This (<a href="https://www.cs.unm.edu/~mueen/DTW.pdf">tutorial</a>) also explains the main idea of DTW, described in the original paper by (<a href="http://ieeexplore.ieee.org/document/1163055/">Sakoe and Chiba: Dynamic programming algorithm optimization for spoken word recognition</a>)</p>
<p>Outline:</p>
<ul>
<li>Introduction to Dynamic Time Warping: <em>dtw()</em></li>
<li>Incremental Calculation of DTW: <em>idtw()</em></li>
<li>Calculation Time and Comparisons</li>
<li>Decremental Dynamic Time Warping: <em>dec_dm()</em></li>
<li>Vector-based Implementation of DTW: <em>dtw2vec()</em></li>
</ul>
<p>   </p>
<!-- % https://colinfay.me/writing-r-extensions/writing-r-documentation-files.html -->
<div id="introduction-to-dynamic-time-warping-dtw" class="section level2">
<h2>Introduction to Dynamic Time Warping: <em>dtw()</em></h2>
<p>The distance measure DTW calculates the minimal costs of the shortest non-linear alignment of two time series <span class="math inline">\(Q\)</span> (the query time series) and <span class="math inline">\(C\)</span> (the candidate time series), conditional to</p>
<ul>
<li>The first element of <span class="math inline">\(Q\)</span> is aligned to the first element of <span class="math inline">\(C\)</span></li>
<li>The last element of <span class="math inline">\(Q\)</span> is aligned to the last element of <span class="math inline">\(C\)</span></li>
<li>A 1:k alignment is applied (unlike to the Euclidean distance calculation). That is, one observation of <span class="math inline">\(Q\)</span> can be applied to k-many of <span class="math inline">\(C\)</span>, and vice versa.</li>
</ul>
<p>Remark: The DTW distance measure is not a distance metric in the conventional sense, since it does not fulfill the triangle inequality.</p>
<p>In the following we show by aid of toy example how to use the functions of IncDTW and what they are doing. We start with the basic functions. Suppose we have two time series and we need to calculate the DTW distance of these:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1090</span>)</a>
<a class="sourceLine" id="cb1-2" title="2">Q &lt;-<span class="st"> </span><span class="kw">sin</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>)<span class="co">#+rnorm(20)</span></a>
<a class="sourceLine" id="cb1-3" title="3">C &lt;-<span class="st"> </span><span class="kw">sin</span>(<span class="op">-</span><span class="dv">2</span><span class="op">:</span><span class="dv">10</span>)<span class="co">#+rnorm(15)</span></a>
<a class="sourceLine" id="cb1-4" title="4">tmp &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">dtw</span>(<span class="dt">Q =</span> Q, <span class="dt">C =</span> C, <span class="dt">return_diffM =</span> <span class="ot">TRUE</span>, <span class="dt">return_wp =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb1-5" title="5">                   <span class="dt">return_QC =</span> <span class="ot">TRUE</span>, <span class="dt">return_cm =</span> <span class="ot">TRUE</span>, <span class="dt">return_diffp =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"><span class="kw">names</span>(tmp)</a></code></pre></div>
<pre><code>##  [1] &quot;gcm&quot;                 &quot;dm&quot;                  &quot;diffp&quot;               &quot;ii&quot;                  &quot;jj&quot;                  &quot;wp&quot;                  &quot;distance&quot;            &quot;normalized_distance&quot; &quot;cm&quot;                  &quot;diffM&quot;               &quot;Q&quot;                   &quot;C&quot;</code></pre>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAqAAAAHgCAMAAABNUi8GAAAA21BMVEUAAAAAAAMAAAgAAyEAAyIAA+sAA/8ACOsDAAADAwADAwMDIQMDIesDIv8DM+sD6+sD//8IAAAI6uoI6+shAwAh6yEh6+si//8zAwAzMzMz6+tNTU1NTW5NTY5NbqtNjshuTU1uTW5uTY5ubo5ubqtuq+SOTU2OTW6OTY6Obk2ObquOyP+rbk2rbm6rjk2ryKur5OSr5P/Ijk3I///kq27k///q6jPq6urrAwDrCADrIQPrISHrMwPr6wPr6wjr6yHr6zPr6+v/AwD/yI7/5Kv//wP//8j//+T///+0KpfFAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAdfElEQVR4nO2dC3vcxnWGwahK6Uat0pZNw1K25cSynUiJI4kuGTYKg5Ch9v//ouKyu8ACGMztnJkzB9/3+BENzGI/DObdg8HcUO0gSLCq3CcAQWsCoJBoAVBItAAoJFoAFBItAAqJFgDdtuq6vqlPdbO6yZG8doIAdNsCoJBolQRoTSSyL4IDgwMAVVy4GhwAqOLC1eAAQBUXrgYHAKq4cDU4AFDFhavBAYAqLlwNDgBUceFqcACgigtXgwMloBdVoxehRw+bABQOw14yQO/Pz37VQvo86OjxJgCFw7B3GdAmFB4+4YpYx2d9c9H9MX0cgMLBz2EZ0PZefSDUEbFPfehEHRQOpA5kgN71tU8ACgdSB0JAX64lW44+2YwCdFQ5cZTewtXgsAxoQB1USAQd/7QcpbdwNTgYAK2HQvasg346bWgCoHCIcjABWns/xV/sn+L7W73v0eNNAAqHYS8ZoELaQVEHZVBTtLu2bM/qrpwXP3M37aMx6O7F7KPNdvMfN6BNNkT0JPnyWT4+/A631ctdQ2bVhqBP1bOYr2rhXGaZH1CqZAAqzeGuer5ryPxFC9atY6Q0fhUA9VTx+PA73J8/29W3Z/91/qx/1rhr75XPmj9fVA21zT/dvuY+/S/N/udtlK2a/+0eRu72yftj7vp/vug+d3/eB+NUt3iqZAAqzuHi7L/rhqaLs7r907XYNE/Dd22ltEHuZVsv7ShrSGz2t7WAhtE9oH3ycEwbQfvPHb49CNDas6GeMBmAinO4rX55f/687Y1pQfu/tr2mo+p5d/s/IHb439uWvYsDoP2+4ZgXx32HbwegqyofH36HT9W/tl2FDZ19j+Ft9zzcMdb90yUcty/6W/oe0Bf7RvLhmOG4XgB0VeXjk8Dh/J/a23tzf2//fKp6ynwAHR8DQL2kAB9+h4uz7oGm/3PbAnh7BLK7X78cAdrd4m9PbvEvx8cAUC8pwIff4a5v4e7/3HaQHYEcPST14C09JB2Oae/2ANRLCvDhd/jUNRXtuwu7LplfdHf1QztSfXLLb5uZvhg3Mw3HNH/PDp+LamYCoHRS7WDq4rztp1a49oAGzEnalzQAjZZqhwUC29v5ocsegE4FQNM6LBHYzu89Myf7OABQ3fgU7wBAFReuBgcAqrhwNTgAUMWFq8FhBdB9UWcD9PH11dVbALpxh7UI2k+eyAXo0/fvd4/fvAeg23YwA3qYfpYL0Ievm38+TEMoAN2Yw/QWutvdHFBoZU42iCL58vJyv91G0VMB0I05TMq/lhNBG31+92aKMGZ1bszBDGhX1M1/+QB9+m7GJ+bFb81hBdBe0+JO+RQ/e4a3vwrRUDGBlGiJoVNEkwG6yCci6NYcHAA9jaLJAL2+auX9FI86qC4HJ0DHiKInyV9wCHdwBHRAFID6Cw7hDs6AHhAFoP6CQ7iDB6A9ogDUX3AId/ACtEUUgPoLDuEOnoBa20UBKBxIHbwBvalX20UBKBxIHQIAXW0XBaBwIHUIAnSlXRSAwoHUIRBQY7soAIUDqUMwoIZ2UQAKB1KHCEAX20UBKBxIHaIAXWgXBaBwIHWIBHTWLgpA4UDqEA3opF0UgMKB1IEA0JMoCkDhQOpAAugIUQAKB1IHIkCPiAJQOJA6kAHaIzqbcAFA4RDlQAjofsba6lM9AIWDnwMpoAtzKgEoHKIc1AGKWZ26HGgBPaxGEng0AaCYF6/MgRjQftPcLgpA4eDnwAKouV0UgMLBz4EJUFO7KOqgcPBzYAN0jyie4uEQ5cAIaB26eCMAhcOwlxPQwMUbASgchr28gAYt3ghA4TDs5QY0YPFGAAqHYS8/oN6LNwJQOAx7UwDquXgjAIXDsDcNoF6LNwJQOAx7UwHqsXgjAIXDsDcdoM6LNwJQOAx7UwLquHgjAIXDsDctoE6LNwJQOAx7UwPqsHgjAIXDsDc9oNbFGwEoHIa9OQC1LN4IQOEw7M0D6OrijQAUDsPeXICuLN4IQOEw7M0HqHHxxuPZfH43e58sAN2YQ1ZAZ6uRTAC9nr1LFoBuzSEzoDenq5GcAvr4298B0K07TAHY7W7mu1iTO0BPki8vL9s/n//wJ9ziN+8wKf86eQStjRH0+k1IHRSzOnU55AfUVAd9/PanAEAxL16ZgwBAR3flMaDXV63emAFd1LjCAOmTIEB3Qc1MiKDKHLQBOl++zCq9havBQTSgC7I/xfff6IGo3sLV4KAUUB9E9RauBgcRgNbLDfVRgLojqrdwNTgoBtQVUb2Fq8FBNaBuiOotXA0OygF1QVRv4WpwUA+ovXNeb+FqcNgAoLYgqrdwNTjIAPRAKA+gFkT1Fq4Gh20Auoqo3sLV4LAVQFcQ1Vu4Ghy2A6gRUb2Fq8FhS4AaENVbuBochABaj9+qxAfoIqJ6C1eDw9YAXWgW1Vu4Ghy2B+gsiOotXA0OGwR0iqjewtXgsElATxHVW7gaHMQAOnqzZwJAx4jqLVwNDkIA3c91SwjogKjewtXgsGFAD4jqLVwNDpsGtEPUfykSb+nFh99BBKBHTJIDGjSR3lt68eF3EADoiA8ACofp3tyAntABQOEw3ZsX0AkbGQANWIrEW3rx4XfICqhtCfAkgPYXhhVRvfjwO+QElOclCt7afxEjonrx4XfIB+josX2SnAdQRkT14sPvkAvQqjIn5wKUDVG9+PA75AF0sub3JDkfoEyI6sWH3yEHoLOGz8lmTkBZENWLD79DekAXGj4nm3kBZUBULz78DskBXWr4nGzmBpQcUb348DskBnRa8kIBJUZULz78DkkBnTXMywWUFFG9+PA7JAR04e3GkgElRFQvPvwOyQBdfD+8bEDJENWLD79DIkAPJV0YoESI6sWH3yEJoNN3HVqOlgQoCaJ68eF3SAFotZ4825QFKAGievHhd+AHdK1hvgxAoxHViw+/AzegiyOSLUfLAzQSUb348DvwAmoYkWw5en8un99dvXovBdAoRPXiw+/ABehhIkUEoB/e7h6++kkMoBGI6sWH34EJ0ONUtHBAn374KOgW3ysQUb348DvMEbhZwMI7uQM09OjLy8vm38dv/yjqFt8raKUHvfjwO0zKv6aJoBVBBH18/baBVNItvlfAPGW9+PA7cADalt+hECMAbeB8+n4aQpfCclqZbg5QChEAehpeIuqgv7cAWhMJEVSyAzWgTgM+Lcn7c/kg8xYfsNKDXnz4HWgBdRzwaUnen8vTd1dfzh7kBQDaywdRvfjwOxACWjkP+LQkT6EUCagPonrx4XcgA3T5oUgzoO6I6sWH34EIUNNEd92AuiKqFx9+BxJAzRPdtQPqhqhefPgdCAD1H09nSS4KUBdE9eLD7xANaMh4OktyYYAuvF2R3MEmvQ6RgIaNp7MkFweoLYjqxYffIQbQpXalbQJqQVQvPvwO4YBGdLZbkksEdBVRvfjwO4QCur6Aou3o9eQyAV1BVC8+/A5hgNoWUFw/2pZcKqBGRPXiw+8QAqh9AcW45HIBNSCqFx9+B39A19uVtg7oIqJ68eF38AR0PhQSgM40I1QvPvwOXoBSDVeyJJcO6CyI6sWH38EDUI/16eKSiwd0iqhefPgdnAH1Wp8uLlkBoKeI6sWH38ERUM/16eKSVQA6vmZ68eF3sAFa9VM0hx0A1F2H66YXH34HC6DVbA4jAPVRf+304sPv4ALoyQEA1E9BS5F4C4AeBUB9FTCR3lubBXT+6wegvgKgMQ5WQDkItCQDUG9tFlCeEcmWZGWABixF4i0AehQADXRgRXSrgFY1AKVzYEQUgB4FQCMc2BDdKKDBS9DGJesFlA1RAHoUAI10YEF0m4CyTdu0JOsGlAVRAHoUACVwICd0k4AuDwAFoBQO1EEUgB4FQGkcaBEFoEcBUCoHSkS3CCjj0iGW5I0ASokoAD0KgFI6UCG6QUBNk5AAKK0DDaIAtDZsAtBoBwpEc+eBz8EEKOvqYJbkjQFK0SyaPw9cDgBUQuFGB1EBeWByMABqnmcMQFkcIhEVkQcWBwAqpXCjEBWSBwaHZUCZFwC1JO/P5fG15Hd1MjhEIComD+QOS4CezvHKBWj7Ku7rrwS+7ZjRIRhRQXkgdlgAdDILMReg7au4n36YhlDdgAYjKioPpA7TW+hu1wM6339INqaQJV9eXu62GUFbBS1FIiwPhA6T8q/lRND2ffEzPjcAaNBEenF5IHNYAHQyjzvbLf6b97uH2VOSObTr0fotbNsaMZN7sMhDEz7b2/ypEEEpHAIkKYLuxfcqOUtyfyrWCLqYnwDJK1z/pUjk5YHKYQXQPaLZ6qAPV1evpgF0G4D28kFUah7iHVYBxdI3eR3cEZWbh1gHC6A879u2JAPQo1wRlZyHOAcboLNrBEDTOrghKjsPMQ52QG9OhysC0NQOLohKz0O4gwugeMtHZgc7ovLzEOrgBCjek5TbwUZoCXkIc3AE1NhuD0DTOFiCaBF5CHJwBtTQbg9AUzmsIlpIHgIc3AFdbrcHoOkcVhAtJg/eDj6AdpcIgGZ0MCJaUB48HfwAbS4RAM3qYEC0qDx4OfgCOrtCADSxwyKiheXBw8Eb0JvJFQKgyR0WEC0uD84OAYCyT/oEoDbNCC0wD44OQYCOf8MANIfDNIiWmAc3hzBAR1cIgOZxOEW0zDy4OIQCyrkAMwB10hjRUvNgdwgHdD8/FoDmcxgQLTcPNocIQBdndwHQpA6Hy19yHtYdAGjhhdsXQNl5WHOIB5R+wD0A9VLQUiTeKhLQvg66ttQYAE3hEDCR3ltlArrfNjeLAtAUDgDUvLnfPl4gAJrBAYCaN0ftoksv7wagSRz8lyLxVvmA9ogC0HwOrIhqAHRhmQcAmtSBEVEdgNIMF40E9FP1/FN11DPTx45SBCgjoloApVjhnjKC3lYvbR9RBSgbonoAraNH41ECenf2K9tHlAHKhKgqQCNH40UCuulbfC8GRJUBGrX8LWUE3d4tvhc5oeoA3Tfe5wZ0i7f4TtRBVCGgdejqopSAOkgnoNSI6gQ0bHVRAErkQImoVkBDBjsBUDIHOkT1AlqPW0YBaGoHKkQ1A1oPlwmApnegQVQ5oF6DneIB/VQ9b/84tDHVufFJ4UCBqHpAPQY7IYKSO8QTugFAnQc7AVB6h+gguglA63o68psL0Lt9Rydu8UdFIroRQG/q1WanCaCPv/k4fSu3G6D352crqROJwCeFQxSi2wG0v1DV4kPTKaAPV19+3H1+93Z3/bUnoPuHJDcJwSeFQwSiWwJ0NKF+DdAPr35sIujTDx/7SOoXQQHosoIRFQJoo5v5LvrkDlBT8uXlZb/Zgvn47clr4x3roG4NTGsXhlKiHAIRFQJonSaC1i4RtAf04StfQEeDQfGQtKSgpUg2BmjtDGhYBPWRMHxSOARMpN8aoHXfeGwH1FwHXdE/qp+3f/5e/dLp45uToYZVgFICWpvGMx/PpgXz87s3wU/x6Oo0CBHULXn2WjCadtCLYxX0zPiZkcThk8DBfymSTQI6ey0Y8WARN8nDJ5WDD6LbBHQ6iAF98Ykd3BEFoEMyAaDoi3eVK6IbBfRmaexIPKD358/uz5873ugl45PCwQ3RrQJ6GkMp66Dnz+pb+5zjWjo+KRxcEN0soAvvVaQB9OIMzUzOsiO6XUDHhJLVQc87Oi8QQZ1lIxSADskEgDaV0Pq8ql6sfeagEvBJ4GAJohsGdEQomplyOqwiumVAB0IBaF6HFUQ3DeiRUDpAu+5Ot+6kYvBJ4WBEdNuAnr46mQDQi/b5/ZPD4qB1UfikcDAgunFA6/FqovGAYjRTjBYRBaDDJgDN7bCA6NYBrUeTPOMBbdB8gVt8jGaEbh7Q0QB7igjqMS2pQHwSOEyDKAAdBtgTRFAflYhPCodTRAHoMMAegApxGCMKQI8zPQGoHIcBUQA6TOUCoIIcDogCUAAq1GF/W2N06AVADSobnxQOQUuReEs8oMerEA/o0Mx0tvKpvUrHJ4VDwER6b0kHlLId9NgX77JQaPn4AFDzJllXJ2lP0tDVudV3dRJr84ASj2YCoNTyX4rEW4IBrcjHgx6H2zlMS1KATyoHVkTlAsox5eO2H7B84TAtSQ0+KRwYERULKMekOR8pwieFAxuiQgFdeOkHAJXtwISoTEB5lr7B2ky8DiyIigSUafEwvCeJ24EBUYGAzl6NSNzM5CaF+KRwICdUHqDWJcAjIigAZXegDqLSAHV4y0cwoHhPUhIHWkSFAVqZk+MBPQ4WwUMSrwMlorIArVaSCSKoj/Tik8KBDlFJgE76NifJALQoBypEBQE67ducbEYC2jzC4xaf1IEGUTGAVrO+zckmImhxDhSISgF0YVH6ySYALdAhnlAhgC71bU42KQDF8oupHaKDqAhAp7ngAhTLL2ZwiERUAqDTrk0LoN27Oh9fX1299QQUq9vlcYhCNDOg3ZwBt6MPJ/Nw9eXH7l3xj994vi8egOZyiEA0L6D7WVc+gH549WMTQR/aV3F/OIZQLL8o3SEYUSdAG93MdxEkd4A6Hn15edlvdrf4Rm0UPXzP8OGVvGL5xZwOgYhmjaBVQAQ9Avr53ZsBdCdAvSSqcHU4BC1FkhHQ9lyrpdFLToA+fTfwieF2hTgETKTPBuhKz5HbU/zb0QlWOxf9o/q50+cgLu2rdOQiB3TyO/IH9JRP53ZQp7d09hIXfTQ4FBJBDXM6LEefAHp91crzKR6DRbI7+C9Fkh7QhaciP0AXhIekohx8EE0MaDVeDszvaACqyMEd0aSAro9IthxNACjmxctxcEU0IaCVZUSy5cvjAb0/f3Z//txx8rHkwtXh4IZoMkAXFrPxOHp+TgGAtmieP6tvnZ7lZReuDgcXRNMAOm1cyAfoxRkGiwhysCOaAtBZs1KuOuh5R6dba6j8wtXhYCOUH1DnznZLMgGgTSW0Pq8cFgetyyhcFQ6WIMoN6GKzUg5AP7k9vB9VROHqcFhFlBXQY9VTAKBt6HRsYertXD8YLDgctYIoI6DmZqVsDfV37pAWU7g6HIyIsgG61qyUtyfpAk/xEh0MiDIBut6slA/Q++ZG7zTjo6zC1eGwiCgHoFXYcCVLMgGgDZ3OA+4KK1wdDguI0gNqXuHT5Whzciyg7aINTg1MvYorXB0OM0KpAa1WVvi0H72WHAmo1/rfdZGFq8JhGkRJAa2ihitZkmMjaFv99GgJLbFwdTicIkoIqHV9urjkWEDrrpXpbC19rDILV4fDmCQKQLuHotVZRkIArbuaqFtFtNTC1eEw0EQAaLUwFUosoN2tHu2g8h0ORFEBak5e2ERPEhzs6qHaDKD36IsvzsG8FIkXoAsN8wIBxWimEh1ME+n9AE2THAmor8ovXA0OANSo8gtXgwMANar8wlXhQFIHTZMMQOEw7AWgegtXgwMAVVy4GhwAqOLC1eAAQBUXrgYHAKq4cDU4AFDFhavBAYAqLlwNDgBUceFqcACgigtXg8MaDBIFQDfmkA+1MAHQjTnkQy1MHC+HgiAyAVBItAAoJFoAFBItAAqJFgCFRAuAQqIFQCHRAqCQaAFQSLQAKCRaABQSLQAKiRYAhUQLgEKihfGgG3PIh1qYAOjGHPKhFiYAmsfBsPYcpdQBekMksi9S7NCt3snssZyHfKiFCRE0i4NpeVlKqYugRNcl282rGIfqIE4TAGpQvthQhMPh6nR/eC8UAJ2oqhKFhlIBPbkyu/0uDqOxw2xvYbICasatmmi0N/7qrqpEQKdXZXfcT241cZjsLUw2QKfo2cNkm5KldiXXYelq7UappGYLDid7C5MToH737V2dp3Yl08F05XYnnyGzMziM9hYmjwjqd2HS167kOaxdu1MHjqu1DUADWo2OtSvP4/wd+BTvYPthTx3oa+7qACXvwWDrKxHfk+TQTbTgQHy90JNk/+Umrf4LcXCsEy06kEZRdRGU48KkrP7ndBia310zbKxReTr7OuRDLUzsffHpqv8ZHQI6KIwOZBcMgDpeGHpCZQJK5kCEKAB1vTCJnk8zOtACSnTFAKj7hSEmVBqgId27FgeCVicA6nFhaIOoMECD8mZ3iL1mANTrwvA3oFDKxyEsZy4OcYgCUK8Lw9+AQil3h9BsuTnEXDR1gPL2YNwQ9pQI6kkKzpKrQ/hFQ0+S1y+3E1EQlRNBwzOUK0bnQy1MiSfN0dznxQBKfgM22FQxg3YmewtT8lmdfC18lHJyiPq1BTRkkbS05kMtTOmnHRMEURmAxuUjV1dAPtTClGNePFMTNKUcHFhaKc1uADQdoExN0JSy/8hif2UB46U8PQGo14U5FUcTNKVsDpmqKV62ANTrwkyV7gGDwYHgSS8sD/ED+vKhFqZ8azNFBNHcgGZsifC4auoADe2xcOvBWBB7L0y41hxoOsSC8+DsvomepF+3VfN/9vuRS+nHjpHk3rC4SSX5UAvTKqB/Oz/7n7r+S/Uzrwvo20fir5yA8k7IcJLjKWwA0H9v+azrv/rFUM8+ErJOPEqZHOiGZMXkwe0s9AN6BPPXPaiOyjxdgkSmIYPsDo4KntisCtA/V//Z/89fDv/jJL2AChp07XAqmwL03zyunVZAZU1bsZ8NAPW6MGb5r9eYBVBxE/9sJ6Qf0KEOynmL70XQiUepuYPAqdOWU9IPaPcU/7fzn/3Vr50psBPPg4AMgJKvPkGRh/WTUgfovNfhf8+r/2j/af71UGgfiXsHTfKeJIZ1+kjysHpem+hJ+vN+0SH2W3wrrzWceXXqwLECGlEeVk5NXQRduQy/9mmpj+jEi+ojodSJg+gV+swntyVAvRTVR8Lu4KaRA9Na5mR5MJ4fAPW6MI6K6MSj1ODAtZA5YR4MpwhADYrsxAvuI6HU0SHxW4zCtHySANSg6D4Sdge7Dg6FvAhi8VcNQA2K/iJrEE0FaEGv0lk4UwBqUK4+EkrtHM6CwIFQ85MFoAbl6iOh1M56DhQOpFp52eLJ3sKUc07SmgL6SAjVdU7wWtDnYXrGm+hJClGuPhI6lfrG5tNzVhdBqS5Trj4SOpUK6OklA6AG5eojoVOxgJ5cMgBqUK4+EjLTkHl83uLKw3DiANSgXH0kRI4Vt0MvNofjJQOgBuXqI6G0KxjQI6EA1KBcfSSUXiUDeviVAVCDcvWRxBvZ6m+UYnVYqabkQy1MBQA6v83zNNGMXQoHtCNUHaBUPRoM/TxOfSRxDqcWgt7EFCZjX1g+1MJUQgStp0G00Bid1MHUlpsPtTAVAuhpTZT6MSxZLTehAwA1iusRhsshbUNWKgcAahRbHwlLI9Byn1H5gJp6w/KhFqaCALU1QQd9Y5bO1JwO+VALU1GA1sT9POYedwAqRWUBStpTvjYgBIBKUWGArjVBB3yRUQBUiooDNGhR+4VvkTDrKYdDPtTCVEZP0okIJgxZjy++J8nokA+1MJUXQYPenT75AutHEEGlqFRAwzF1OgiASlGBgI7roN6YOn4YgEpRiYDOHNwxjXuNIKUAqJtUANrLjql7rAWgUqQI0F5mTIW/piGRQz7UwqQO0F6nmPYPVbQOsQKgblIKaK9q9MDP4xAuAOom1YD2CmmQkpYHOod8qIWpwJ4kb4eAridxeSBzyIdamDYQQY1jdwkd/IUI6qZNAAqH0d7CVNk/4qtL+q+Eg0iHFAKgcBAtAAoH0WIAFILoBEAh0QKgkGgBUEi0ACgkWtSAPr6+unpL/J1TfX7H6/D53dWr96wOzVX68iOrwW+ar3/67uqrnzhdUogY0Kfv3+8ev+Et3d0180/gw9vdA2vJtlfpmtPhoeW//R1ff81nkkbEgD60F+QDLz+Pv/0dq8HTD6zBrdHjtz+xunx49WMTQVuHLpIWLYY6aBsfGPX5D3/ivcU/fvtH5ls8ewTtwOx+BrxlkUD0gH5+94b8O8e6fsNcB318/bYrXEax1w5bQNtqCgCd6ek7Xj4bdLgBZY88bS39gfUpCRHUpDb8sOr6qhXnj+Dp99wFyx/bHlEHXRY7n624m5k+cN/i00TQtq6Fp/iJ+vjGDCk3oE0NkbeVcvdwxfwYhnZQCEoiAAqJFgCFRAuAQqIFQCHRAqCQaAFQSLQAKCRaABQSLQAKidb/A+hfqMIGtkE1AAAAAElFTkSuQmCC" style="display: block; margin: auto;" /></p>
<p>Another toy example:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1090</span>)</a>
<a class="sourceLine" id="cb3-2" title="2">Q &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">0</span>)</a>
<a class="sourceLine" id="cb3-3" title="3">C &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">2</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb3-4" title="4"></a>
<a class="sourceLine" id="cb3-5" title="5">tmp &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">dtw</span>(<span class="dt">Q =</span> Q, <span class="dt">C =</span> C, <span class="dt">return_diffM =</span> <span class="ot">TRUE</span>, <span class="dt">return_wp =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb3-6" title="6">                   <span class="dt">return_QC =</span> <span class="ot">TRUE</span>, <span class="dt">return_cm =</span> <span class="ot">TRUE</span>, <span class="dt">return_diffp =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb3-7" title="7"><span class="kw">names</span>(tmp)</a></code></pre></div>
<pre><code>##  [1] &quot;gcm&quot;                 &quot;dm&quot;                  &quot;diffp&quot;               &quot;ii&quot;                  &quot;jj&quot;                  &quot;wp&quot;                  &quot;distance&quot;            &quot;normalized_distance&quot; &quot;cm&quot;                  &quot;diffM&quot;               &quot;Q&quot;                   &quot;C&quot;</code></pre>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p><img src="data:image/png;base64,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" style="display: block; margin: auto;" /></p>
<p>The matrix of differences diffM simply stores the differences of the two time series <span class="math inline">\(Q\)</span> and <span class="math inline">\(C\)</span>.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">tmp<span class="op">$</span>diffM</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4] [,5] [,6] [,7]
## [1,]    1    0    0   -1   -2   -1    0
## [2,]    1    0    0   -1   -2   -1    0
## [3,]    2    1    1    0   -1    0    1
## [4,]    3    2    2    1    0    1    2
## [5,]    2    1    1    0   -1    0    1
## [6,]    0   -1   -1   -2   -3   -2   -1</code></pre>
<p>The global cost matrix is calculated by walking through the matrix of absolute differences <code>abs(diffM)</code> from top left to bottom right applying the following rule:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">cm &lt;-<span class="st"> </span><span class="kw">abs</span>(diffM) <span class="co"># cost matrix</span></a>
<a class="sourceLine" id="cb7-2" title="2">gcm &lt;-<span class="st"> </span>cm <span class="co"># initialize the global cost matrix</span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb7-4" title="4">   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb7-5" title="5">      gcm[ , <span class="dv">1</span>] &lt;-<span class="st"> </span>cm[ ,<span class="dv">1</span>]</a>
<a class="sourceLine" id="cb7-6" title="6">      gcm[<span class="dv">1</span>,  ] &lt;-<span class="st"> </span>cm[<span class="dv">1</span>, ]</a>
<a class="sourceLine" id="cb7-7" title="7">      gcm[i, j] &lt;-<span class="st"> </span>cm[i, j] <span class="op">+</span><span class="st"> </span><span class="kw">min</span>(<span class="kw">c</span>(gcm[i<span class="dv">-1</span>, j<span class="dv">-1</span>], </a>
<a class="sourceLine" id="cb7-8" title="8">                                    gcm[i  , j<span class="dv">-1</span>],</a>
<a class="sourceLine" id="cb7-9" title="9">                                    gcm[i<span class="dv">-1</span>, j  ]))}}</a></code></pre></div>
<p>The direction matrix dm is calculated simultaneously to the global cost matrix and stores for each position where to go next to make the cheapest step.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1">dm &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>, <span class="dt">ncol=</span><span class="kw">length</span>(C), <span class="dt">nrow =</span> <span class="kw">length</span>(Q))</a>
<a class="sourceLine" id="cb8-2" title="2">dm[<span class="dv">1</span>,  ] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb8-3" title="3">dm[ , <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb8-4" title="4">dm[<span class="dv">1</span>, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="ot">NA</span></a>
<a class="sourceLine" id="cb8-5" title="5"></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</a>
<a class="sourceLine" id="cb8-7" title="7">   <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb8-8" title="8">      min_index &lt;-<span class="st"> </span><span class="kw">which.min</span>(<span class="kw">c</span>(gcm[i<span class="dv">-1</span>, j<span class="dv">-1</span>], </a>
<a class="sourceLine" id="cb8-9" title="9">                               gcm[i  , j<span class="dv">-1</span>], </a>
<a class="sourceLine" id="cb8-10" title="10">                               gcm[i<span class="dv">-1</span>, j  ]))</a>
<a class="sourceLine" id="cb8-11" title="11">      <span class="cf">if</span>( min_index <span class="op">==</span><span class="st"> </span><span class="dv">1</span>){</a>
<a class="sourceLine" id="cb8-12" title="12">         dm[i, j] &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb8-13" title="13">      } <span class="cf">else</span> <span class="cf">if</span>( min_index <span class="op">==</span><span class="st"> </span><span class="dv">2</span>){</a>
<a class="sourceLine" id="cb8-14" title="14">         dm[i, j] &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb8-15" title="15">      } <span class="cf">else</span> <span class="cf">if</span>( min_index <span class="op">==</span><span class="st"> </span><span class="dv">3</span>){</a>
<a class="sourceLine" id="cb8-16" title="16">         dm[i, j] &lt;-<span class="st"> </span><span class="dv">3</span></a>
<a class="sourceLine" id="cb8-17" title="17">      } } }</a></code></pre></div>
<p>In case the cost matrix, or the matrix of differences is already in storage, and you want to save calculation time, you can use these matrices also as input:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">IncDTW<span class="op">::</span><span class="kw">dtw</span>(<span class="dt">Q =</span> tmp<span class="op">$</span>diffM, <span class="dt">C =</span> <span class="st">&quot;diffM&quot;</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">IncDTW<span class="op">::</span><span class="kw">dtw</span>(<span class="dt">Q =</span> <span class="kw">abs</span>(tmp<span class="op">$</span>diffM), <span class="dt">C =</span> <span class="st">&quot;cm&quot;</span>)</a></code></pre></div>
</div>
<div id="incremental-calculation-of-dtw-idtw" class="section level2">
<h2>Incremental Calculation of DTW: <em>idtw()</em></h2>
<p>The main intention of idtw() is to compare the DTW distance for different subsets of two time series. That is to compare the DTW(<span class="math inline">\(Q\)</span>, <span class="math inline">\(C_0\)</span>) with DTW(<span class="math inline">\(Q\)</span>, <span class="math inline">\(C_1\)</span>) where <span class="math inline">\(C_1\)</span> could be the extension of <span class="math inline">\(C_0\)</span> for couple of observations.</p>
<p>Another possible application is a live data stream and you want to update the DTW calculation each time a set of values of <span class="math inline">\(Q\)</span> are observed. Of course this depends on the application and certainly does not make sense in any case, since a time warp of two time series where the lengths differ <em>too much</em> is questionable. A reasonable range for the ratio n/m depends on the application and purposes of the data analysis.</p>
<p>Assume we already have calculated the DTW of <span class="math inline">\(C\)</span> and <span class="math inline">\(Q\)</span>, when an update of <span class="math inline">\(C\)</span> provides new observations:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1030</span>)</a>
<a class="sourceLine" id="cb10-2" title="2">C0 &lt;-<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">1000</span>))</a>
<a class="sourceLine" id="cb10-3" title="3">Q &lt;-<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">800</span>))</a>
<a class="sourceLine" id="cb10-4" title="4">tmp0 &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">dtw</span>(<span class="dt">Q =</span> Q, <span class="dt">C =</span> C0)</a>
<a class="sourceLine" id="cb10-5" title="5">gcm0 &lt;-<span class="st"> </span>tmp0<span class="op">$</span>gcm</a>
<a class="sourceLine" id="cb10-6" title="6">dm0 &lt;-<span class="st"> </span>tmp0<span class="op">$</span>dm</a></code></pre></div>
<p>To update the DTW distance for new observations of <span class="math inline">\(C\)</span> we recycle as much from previous results as possible to keep calculation time low:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">C_new &lt;-<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb11-2" title="2">C_update &lt;-<span class="st"> </span><span class="kw">c</span>(C0, C_new) </a>
<a class="sourceLine" id="cb11-3" title="3"></a>
<a class="sourceLine" id="cb11-4" title="4"><span class="co"># result from incremental calculation</span></a>
<a class="sourceLine" id="cb11-5" title="5">res_inc &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">idtw</span>(<span class="dt">Q =</span> Q, <span class="dt">C =</span> C_update, <span class="dt">newObs =</span> C_new, </a>
<a class="sourceLine" id="cb11-6" title="6">                    <span class="dt">gcm =</span> tmp0<span class="op">$</span>gcm, <span class="dt">dm =</span> tmp0<span class="op">$</span>dm)</a></code></pre></div>
<p>Finally we compare the results from the incremental calculation with the one from scratch:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co"># result from scratch</span></a>
<a class="sourceLine" id="cb12-2" title="2">res_scratch &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">dtw</span>(<span class="dt">Q =</span> Q, <span class="dt">C =</span> C_update) </a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">sapply</span>(<span class="kw">names</span>(res_inc), <span class="cf">function</span>(x){<span class="kw">identical</span>(res_inc[[x]], res_scratch[[x]])})</a></code></pre></div>
<pre><code>##            distance                 gcm                  dm normalized_distance 
##                TRUE                TRUE                TRUE               FALSE</code></pre>
</div>
<div id="decremental-dynamic-time-warping-dec_dm" class="section level2">
<h2>Decremental Dynamic Time Warping: <em>dec_dm()</em></h2>
<p>Now that we have understood the incremental approach and tested the calculation time and correctness of results, we want to introduce another concept, which is just the reverse: Instead of adding new observations to the time series x, in this section we introduce an easy and fast way of reducing most current observations, conditional to already existing calculation results including all observations of <span class="math inline">\(C\)</span>.</p>
<p>Of course this is only interesting if you are interested not only in the DTW distance, but also want to know about the warping path. Meanwhile the DTW distance could be directly taken from the global cost matrix from previous calculations (by selecting the value of the last row and last but k column, k is the number of reduced observations of <span class="math inline">\(C\)</span>), we cannot update or modify the previous warping path but need to calculate it again from scratch. This is required, since adding or neglecting observations causes an updated alignment of the two updated time series, and in general the new alignment could be completely different from the original.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1150</span>)</a>
<a class="sourceLine" id="cb14-2" title="2">Q &lt;-<span class="st"> </span><span class="kw">cos</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb14-3" title="3">C &lt;-<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">80</span>))</a>
<a class="sourceLine" id="cb14-4" title="4">Ndec &lt;-<span class="st"> </span><span class="dv">4</span></a>
<a class="sourceLine" id="cb14-5" title="5"><span class="co"># the ordinary calculation</span></a>
<a class="sourceLine" id="cb14-6" title="6">result_base &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">dtw</span>(<span class="dt">Q=</span>Q, <span class="dt">C=</span>C) </a>
<a class="sourceLine" id="cb14-7" title="7">gcm0 &lt;-<span class="st"> </span>result_base<span class="op">$</span>gcm</a></code></pre></div>
<p>To update the DTW distance by decreasing x for some observations (say 4), again we recycle as much from previous results as possible to keep calculation time low:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="co"># the ordinary calculation without the last 4 observations</span></a>
<a class="sourceLine" id="cb15-2" title="2">result_decr1 &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">dtw</span>(<span class="dt">Q=</span>Q, <span class="dt">C=</span>C[<span class="dv">1</span><span class="op">:</span>(<span class="kw">length</span>(C) <span class="op">-</span><span class="st"> </span>Ndec)], </a>
<a class="sourceLine" id="cb15-3" title="3">                            <span class="dt">return_wp =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb15-4" title="4">gcm1 &lt;-<span class="st"> </span>result_decr1<span class="op">$</span>gcm</a>
<a class="sourceLine" id="cb15-5" title="5"></a>
<a class="sourceLine" id="cb15-6" title="6"><span class="co"># the decremental step: reduce C for 4 observation</span></a>
<a class="sourceLine" id="cb15-7" title="7">result_decr2 &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">dec_dm</span>(result_base<span class="op">$</span>dm, <span class="dt">Ndec =</span> Ndec) </a>
<a class="sourceLine" id="cb15-8" title="8"></a>
<a class="sourceLine" id="cb15-9" title="9"><span class="co"># compare the results: ii, jj, wp and the gcm of </span></a>
<a class="sourceLine" id="cb15-10" title="10"><span class="co"># result_decr1 (conventional) and result_decr2 (recycling previous results)</span></a>
<a class="sourceLine" id="cb15-11" title="11">comparison_<span class="dv">0</span> &lt;-<span class="st"> </span><span class="kw">c</span>(</a>
<a class="sourceLine" id="cb15-12" title="12"><span class="kw">identical</span>(result_decr1<span class="op">$</span>ii, result_decr2<span class="op">$</span>ii),</a>
<a class="sourceLine" id="cb15-13" title="13"><span class="kw">identical</span>(result_decr1<span class="op">$</span>jj, result_decr2<span class="op">$</span>jj),</a>
<a class="sourceLine" id="cb15-14" title="14"><span class="kw">identical</span>(result_decr1<span class="op">$</span>wp, result_decr2<span class="op">$</span>wp))</a>
<a class="sourceLine" id="cb15-15" title="15">comparison_<span class="dv">0</span></a></code></pre></div>
<pre><code>## [1] TRUE TRUE TRUE</code></pre>
</div>
<div id="vector-based-implementation" class="section level2">
<h2>Vector-based Implementation</h2>
<p>The matrix based implementation is perfect for a detailed analysis of the alignment of two time series. However for calculating the distances of many time series it has one major drawback, the computation time. If the data analysis task is to cluster or classify a database of time series a distance matrix of pairwise distances is required. Obtaining such a distance matrix is computationally expensive, and so the classic DTW implementation maybe is considered as too slow. The vector-based implementation offers a solution which is much faster than the matrix based implementation since no matrices are allocated. The computation principle is the same as for the matrix-based method, however instead of allocating the two cost matrix, global cost matrix and direction matrix only two vectors are allocated. To achieve the DTW distance between the time series Q and C the calculation of the j-th column of the global cost matrix solely depends on the values of the former column and the respective distances of the time series C and the j-th entry of Q. Since there is no dependence on the second last column the algorithm overwrites this column. This principle is implemented in the functions <em>dtw2vec()</em> and the incremental equivalent <em>idtw2vec()</em>.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1">Q &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb17-2" title="2">C &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">120</span>)</a>
<a class="sourceLine" id="cb17-3" title="3">IncDTW<span class="op">::</span><span class="kw">dtw2vec</span>(Q, C, <span class="dt">ws =</span> <span class="dv">30</span>)<span class="op">$</span>distance</a></code></pre></div>
<pre><code>## [1] 90.13429</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">IncDTW<span class="op">::</span><span class="kw">dtw</span>(Q, C, <span class="dt">ws =</span> <span class="dv">30</span>)<span class="op">$</span>distance</a></code></pre></div>
<pre><code>## [1] 90.13429</code></pre>
<p>We can also perform the incremental calculation with the vector based implementation with <em>idtw2vec()</em>, which can distinguish between an initial calculation and the incremental. For this example we simulate time series as univariate random walks.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1210</span>)</a>
<a class="sourceLine" id="cb21-2" title="2">Q &lt;-<span class="st"> </span><span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">800</span>))</a>
<a class="sourceLine" id="cb21-3" title="3">C_initial &lt;-<span class="st"> </span>Q[<span class="dv">1</span><span class="op">:</span><span class="dv">750</span>] <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">750</span>)</a>
<a class="sourceLine" id="cb21-4" title="4">resV_init &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">idtw2vec</span>(<span class="dt">Q =</span> Q, <span class="dt">newObs =</span> C_initial, <span class="dt">gcm_lc =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb21-5" title="5"></a>
<a class="sourceLine" id="cb21-6" title="6">C_newObs &lt;-<span class="st"> </span>Q[<span class="dv">751</span><span class="op">:</span><span class="dv">800</span>] <span class="op">+</span><span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">50</span>)</a>
<a class="sourceLine" id="cb21-7" title="7">resV_inc &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">idtw2vec</span>(<span class="dt">Q =</span> Q, <span class="dt">newObs =</span> C_newObs, </a>
<a class="sourceLine" id="cb21-8" title="8">                             <span class="dt">gcm_lc =</span> resV_init<span class="op">$</span>gcm_lc_new)</a></code></pre></div>
<p>Also we compare the DTW distance of the incremental calculation <em>idtw2vec()</em> with the one from scratch <em>dtw2vec()</em> and see that the distance measures are equal.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1">C_update &lt;-<span class="st"> </span><span class="kw">c</span>(C_initial, C_newObs)</a>
<a class="sourceLine" id="cb22-2" title="2">resV_scr &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">dtw2vec</span>(<span class="dt">Q =</span> Q, <span class="dt">C =</span> C_update)</a>
<a class="sourceLine" id="cb22-3" title="3">resV_scr<span class="op">$</span>distance <span class="op">-</span><span class="st"> </span>resV_inc<span class="op">$</span>distance</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div id="new-observations-for-both-time-series" class="section level3">
<h3>New Observations for Both Time Series</h3>
<p>If new observations for both time series are available the update of the DTW calculation works in a consecutive fashion similar to the simple case where only one time series is updated. First we update the calculations for the first time series as usual:</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1">resV_init &lt;-<span class="st"> </span><span class="kw">idtw2vec</span>(<span class="dt">Q =</span> Q, <span class="dt">newObs =</span> C_initial, <span class="dt">gcm_lc =</span> <span class="ot">NULL</span>)</a>
<a class="sourceLine" id="cb24-2" title="2">resV_inc &lt;-<span class="st">  </span><span class="kw">idtw2vec</span>(<span class="dt">Q =</span> Q, <span class="dt">newObs =</span> C_newObs, <span class="dt">nC =</span> <span class="kw">length</span>(C_initial),</a>
<a class="sourceLine" id="cb24-3" title="3">                      <span class="dt">gcm_lc =</span> resV_init<span class="op">$</span>gcm_lc_new,</a>
<a class="sourceLine" id="cb24-4" title="4">                      <span class="dt">gcm_lr =</span> resV_init<span class="op">$</span>gcm_lr_new)</a></code></pre></div>
<p>Next we switch places of Q and C as input for <em>idtw2vec()</em> and proceed analogously. Also we need to switch the last column with the last row of the global cost matrix.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1">Q_newObs &lt;-<span class="kw">cumsum</span>(<span class="kw">rnorm</span>(<span class="dv">10</span>))</a>
<a class="sourceLine" id="cb25-2" title="2">resV_inc2 &lt;-<span class="st"> </span><span class="kw">idtw2vec</span>(<span class="dt">Q =</span> C_update, <span class="dt">newObs =</span> Q_newObs, <span class="dt">nC =</span> <span class="kw">length</span>(Q),</a>
<a class="sourceLine" id="cb25-3" title="3">                      <span class="dt">gcm_lc =</span> resV_inc<span class="op">$</span>gcm_lr_new,</a>
<a class="sourceLine" id="cb25-4" title="4">                      <span class="dt">gcm_lr =</span> resV_inc<span class="op">$</span>gcm_lc_new)</a></code></pre></div>
<p>Finally we compare the results with the results from scratch and see that the calculated distance measures are equal:</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">res_scratch &lt;-<span class="st"> </span><span class="kw">dtw2vec</span>(<span class="dt">Q =</span> <span class="kw">c</span>(Q, Q_newObs), <span class="dt">C =</span> <span class="kw">c</span>(C_initial, C_newObs))</a>
<a class="sourceLine" id="cb26-2" title="2">res_scratch<span class="op">$</span>distance <span class="op">-</span><span class="st"> </span>resV_inc2<span class="op">$</span>distance</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">res_scratch<span class="op">$</span>normalized_distance <span class="op">-</span><span class="st"> </span>resV_inc2<span class="op">$</span>normalized_distance</a></code></pre></div>
<pre><code>## [1] 0</code></pre>
</div>
<div id="open-alignments" class="section level3">
<h3>Open Alignments</h3>
<p>The original DTW algorithm has fixed alignments at the beginning and the end of the time series, so that when calculating <em>dtw(Q, C)</em> the first element of Q must be aligned to the first element of C, and the last element of Q to the last element of C. % Here we relax this restriction and allow one time series to be aligned only partially, so <em>dtw(Q, C[1:k])</em>, where the lengths of Q and C are <span class="math inline">\(m\)</span> and <span class="math inline">\(n\)</span> respectively, and <span class="math inline">\(n &gt; k\)</span>. The counterpart is <em>dtw(Q[1:l], C)</em> for any <span class="math inline">\(l&lt;m\)</span>. Once the global cost matrix for the full alignment is determined <em>dtw(Q, C)</em> the DTW distances for possible partial open-end alignments are given by the last column and last row of the global cost matrix. The function <em>dtw_partial()</em> returns the indices of the open-end alignment with the minimum normalized DTW distance.</p>
<p>In the following example we first get the full alignment and use this as input to find the open-end alignment for a partial match of C.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">Q &lt;-<span class="st"> </span><span class="kw">sin</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">50</span>)</a>
<a class="sourceLine" id="cb30-2" title="2">C &lt;-<span class="st"> </span><span class="kw">cos</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb30-3" title="3">tmp &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">dtw</span>(<span class="dt">Q =</span> Q, <span class="dt">C =</span> C)</a>
<a class="sourceLine" id="cb30-4" title="4">IncDTW<span class="op">::</span><span class="kw">dtw_partial</span>(tmp, <span class="dt">partial_Q =</span> <span class="ot">FALSE</span>, <span class="dt">partial_C =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## $rangeQ
## [1]  1 50
## 
## $rangeC
## [1]  1 61
## 
## $normalized_distance
## [1] 0.08396951</code></pre>
<p>Since DTW is reversible (for symmetric step patterns), so <em>dtw(Q[1:m], C[1:n]) = dtw(Q[m:1], C[n:1])</em>, possible open-start alignments can be compared similarly. So for the following time series, where obviously the initial 50 observations of C have no reasonable connection with Q we try to find the best open-start alignment. Considering that we first get the full alignment of the reverse time series and use this as input to find the open-start alignment for a partial match of C.</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">Q &lt;-<span class="st"> </span><span class="kw">sin</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">100</span>)</a>
<a class="sourceLine" id="cb32-2" title="2">C &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">50</span>), Q)</a>
<a class="sourceLine" id="cb32-3" title="3">tmp &lt;-<span class="st"> </span>IncDTW<span class="op">::</span><span class="kw">dtw</span>(<span class="dt">Q =</span> <span class="kw">rev</span>(Q), <span class="dt">C =</span> <span class="kw">rev</span>(C))</a>
<a class="sourceLine" id="cb32-4" title="4"><span class="kw">dtw_partial</span>(tmp, <span class="dt">partial_Q =</span> <span class="ot">FALSE</span>, <span class="dt">partial_C =</span> <span class="ot">TRUE</span>, <span class="dt">reverse =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<pre><code>## $rangeQ
## [1]   1 100
## 
## $rangeC
## [1]  51 150
## 
## $normalized_distance
## [1] 0</code></pre>
<p>Combining the incremental calculation and the partial alignment is also possible since the incremental algorithm returns either the updated global cost matrix (for the matrix based algorithm <em>idtw()</em> or the last column and last row (vector based <em>idtw2vec()</em>) for possible future iterations. As a consequence we can update the partial alignment after each incremental step, where Q is a query pattern and C is recorded at the time of analysis, just like a data stream:</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">Q &lt;-<span class="st"> </span><span class="kw">sin</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">50</span>, <span class="dt">length.out =</span> <span class="dv">200</span>))</a>
<a class="sourceLine" id="cb34-2" title="2">C &lt;-<span class="st"> </span><span class="kw">cos</span>(<span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">5</span>, <span class="dt">length.out =</span> <span class="dv">20</span>))</a>
<a class="sourceLine" id="cb34-3" title="3">tmpi &lt;-<span class="st"> </span><span class="kw">idtw2vec</span>(<span class="dt">Q =</span> Q, <span class="dt">newObs =</span> C)</a>
<a class="sourceLine" id="cb34-4" title="4"><span class="kw">dtw_partial</span>(tmpi, <span class="dt">partial_Q =</span> <span class="ot">TRUE</span>, <span class="dt">partial_C =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## $rangeQ
## [1]  1 24
## 
## $rangeC
## [1]  1 20
## 
## $normalized_distance
## [1] 0.08470878</code></pre>
<p>With new observations of C we can easily update the partial matching:</p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">C_new &lt;-<span class="st"> </span><span class="kw">cos</span>(<span class="kw">seq</span>(<span class="dv">5</span>, <span class="dv">10</span>, <span class="dt">length.out =</span> <span class="dv">20</span>))</a>
<a class="sourceLine" id="cb36-2" title="2">tmp1 &lt;-<span class="st"> </span><span class="kw">idtw2vec</span>(<span class="dt">Q =</span> Q, <span class="dt">newObs =</span> C_new, <span class="dt">gcm_lc =</span> tmpi<span class="op">$</span>gcm_lc_new, </a>
<a class="sourceLine" id="cb36-3" title="3">                 <span class="dt">gcm_lr =</span> tmpi<span class="op">$</span>gcm_lr_new, <span class="dt">nC =</span> <span class="kw">length</span>(C))</a>
<a class="sourceLine" id="cb36-4" title="4"><span class="kw">dtw_partial</span>(tmp1, <span class="dt">partial_Q =</span> <span class="ot">TRUE</span>, <span class="dt">partial_C =</span> <span class="ot">FALSE</span>)</a></code></pre></div>
<pre><code>## $rangeQ
## [1]  1 44
## 
## $rangeC
## [1]  1 40
## 
## $normalized_distance
## [1] 0.0643759</code></pre>
</div>
</div>
<div id="analysing-a-database-of-time-series" class="section level2">
<h2>Analysing a Database of Time Series</h2>
<p>There are three more functions in <em>IncDTW</em> that are highly useful when comparing a set of time series:</p>
<ul>
<li><em>dtw_dismat()</em> calculates distance matrices of pairwise DTW distances, so comparing many time series with many. Especially useful for <strong>clustering</strong> or <strong>classification</strong> of a set of time series.</li>
<li><em>dtw_disvec()</em> calculates vectors of DTW distances, so comparing one time series with many distance matrices of pairwise DTW distances. Especially useful for <strong>k-nearest neighbor</strong> searches.</li>
<li><em>dba()</em> calculates the DTW Barycenter Average of a set of time series that are non-linearly aligned. Especially useful to define a <strong>cluster representative</strong>.</li>
</ul>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
